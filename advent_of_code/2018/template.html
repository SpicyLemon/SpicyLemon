<html>
<head><title>Advent Of Code 2018 - ####</title></head>
<script id="solverWorker" type="text/javascript">
    self.onmessage = function(event) {
        var retval = '';
        try {
            retval = solver(event.data);
        }
        catch(err) {
            console.error(err);
            retval = err.stack;
        }
        self.postMessage(retval);
    };

    var parseInput = function(input) {
        var retval = [];
        input.split(/\s+/).forEach(function(element) {
            retval.push(element);
        });
        return retval;
    };

    var solver = function(puzzleInput) {
        return parseInput(puzzleInput);
    };
</script>
<script type="text/javascript">
    var t0 = null;
    var timerUpdater = null;
    var solverWorker = undefined;

    var solverBlob = new Blob([
        document.querySelector('#solverWorker').textContent
    ], { type: "text/javascript" });
    var solverBlobUrl = window.URL.createObjectURL(solverBlob);

    var updateTime = function() {
        if (t0) {
            document.getElementById("time").innerHTML = '' + (performance.now() - t0) + ' ms';
        }
        else {
            document.getElementById("time").innerHTML = '---';
        }
    };

    var startTimer = function() {
        if (timerUpdater === null) {
            t0 = performance.now();
            timerUpdater = window.setInterval(updateTime, 250);
        }
    }

    var stopTimer = function() {
        if (timerUpdater !== null) {
            window.clearInterval(timerUpdater);
            updateTime();
            timerUpdater = null;
            t0 = null;
        }
    }

    var startSolverWorker = function() {
        if (typeof(solverWorker) === "undefined") {
            solverWorker = new Worker(solverBlobUrl);
            solverWorker.onmessage = onMessage;
        }
        else {
            console.log("Could not start worker because worker was already running.");
        }
    }

    var stopSolverWorker = function() {
        if (typeof(solverWorker) !== "undefined") {
            solverWorker.terminate();
            solverWorker = undefined;
            console.log("Terminated solverWorker: " + new Date().toLocaleTimeString());
        }
    }

    var onMessage = function(event) {
        document.getElementById("result").innerHTML = event.data;
        stopTimer();
        stopSolverWorker();
    };

    var runSolver = function() {
        stopTimer();
        stopSolverWorker();
        var startingString = "starting to calculate: " + new Date().toLocaleTimeString();
        document.getElementById("result").innerHTML = startingString;
        console.log(startingString);
        var puzzleInput = document.getElementById("puzzle_input").value;
        startSolverWorker();
        startTimer();
        solverWorker.postMessage(puzzleInput);
    };

    window.onkeydown = function(event) {
        //If it's the escape key, halt the worker.
        if (event.keyCode === 27) {
            stopTimer();
            stopSolverWorker();
            document.getElementById("result").innerHTML = "halted.";
        }
    };
</script>
<style>
textarea {
    font-family: Consolas,Monaco,Lucida Console,Liberation Mono,DejaVu Sans Mono,Bitstream Vera Sans Mono,Courier New, monospace;
}
</style>
<body>
<h1>Advent of Code 2018 - <a href="https://adventofcode.com/2018/day/~~~~">####</a>
<a href="adventOfCode###.html">###</a> | <a href="index.html">index</a> | <a href="adventOfCode#####.html">#####</a><br/>
<textarea id="puzzle_input" rows="10" cols="100"></textarea><br />
<button id="solve_puzzle" type="button" onclick="runSolver(); return false;">Solve Puzzle</button>
<pre id="result"></pre>
<pre id="time"></pre>
</body>
</html>
